---
title: "PP6"
author: "Sophia Chung"
format: html
editor: visual
---

# Example 5.4

```{r}
#| output: false
library(tidyverse)
library(kableExtra)
library(janitor)
```

## Question 1

```{r}
box <- c(0, 1, 2, 3, 4, 5)
prior <- rep(1/6, 6)

# E = a single marble is selected and it is green
likelihood <- box/5
product <- prior * likelihood
posterior <- product / sum(product)
bayes_table = data.frame(box,
                         prior,
                         likelihood,
                         product,
                         posterior)
bayes_table |>
  adorn_totals("row") |>
  kbl(digits = 4) |>
  kable_styling()
```

I think box 5 is most likely to have been chosen because it has the most green marbles (in fact it only has green marbles).

The posterior probabilities are proportional to the likelihoods since the prior distribution is uniform.

## Question 2

```{r}
prior <- posterior

# E = a second marble is selected from the same box, without replacement, and its color is gold
likelihood <- c(1, 1, 3/4, 2/4, 1/4, 0)
product <- prior * likelihood
posterior <- product / sum(product)
bayes_table = data.frame(box,
                         prior,
                         likelihood,
                         product,
                         posterior)
bayes_table |>
  adorn_totals("row") |>
  kbl(digits = 4) |>
  kable_styling()
```

I think that either box 2 or 3 is most likely to have been chosen given these two marbles, since those two boxes have a somewhat even balance between green and gold marbles.

## Question 3

```{r}
prior <- rep(1/6, 6)

# E = first marble is green and second marble is gold
likelihood <- c(0*1, 1/5*1, 2/5*3/4, 3/5*2/4, 4/5*1/4, 1*0)
product <- prior * likelihood
posterior <- product / sum(product)
bayes_table <- data.frame(box,
                          prior,
                          likelihood,
                          product,
                          posterior)
bayes_table |>
  adorn_totals("row") |>
  kbl(digits = 4) |>
  kable_styling()
```

The posterior probabilities are the same as in the previous part.

## Question 4

```{r}
prior <- rep(1/6, 6)

# E = one marble is green, one marble is gold
likelihood <- 2 * likelihood
product <- prior * likelihood
posterior <- product / sum(product)
bayes_table <- data.frame(box,
                          prior,
                          likelihood,
                          product,
                          posterior)
bayes_table |>
  adorn_totals("row") |>
  kbl(digits = 4) |>
  kable_styling()
```

Nothing changes. The order should not/does not matter because in doubling likelihood, the posterior remains unchanged.
